var photoAll={fileName:'',init:function(){$(".file-upload-img-btn").on('click',function(){var fit=$(this).attr("fit");if($(this).attr("fit")==undefined){photoAll.fileClickObj=$('.file-img-div')}else{photoAll.fileClickObj=$('.'+fit)}photoAll.startVideo()});$("#camCan").on('click',function(){Capture()});$("#camCen").on('click',function(){photoAll.closeCam()});$('.file-img-div').on('blur','.file-name',function(){var id=$(this).parent().attr('id');var name=$(this).val();var fileFit=name+'.'+photoAll.fileName;$.ajax({type:"post",url:$yt_option.base_path+"fileUpDownload/updateFileName",async:true,data:{fileName:fileFit,fileId:id},success:function(data){if(data.falg==0){}$yt_alert_Model.prompt(data.message)}})});$('.active-sdk').on('click',function(){window.open('https://share.weiyun.com/50xdaPR')})},startVideo:function(){if(photoAll.isExitsFunction('StartVideo')){console.log(hdCamidMain);StartVideo(hdCamidMain,3672,2856);BestSize(1);}sysCommon.showModel($('.active-div'))},closeCam:function(){if(photoAll.isExitsFunction('CloseCam')){CloseCam()}sysCommon.closeModel($('.active-div'));},isExitsFunction:function(funcName){try{if(typeof(eval(funcName))=="function"){return true}}catch(e){}return false},setFileUpLoadDom:function(str){var ithisParent=photoAll.fileClickObj;var imgUlr='';$.ajax({type:'post',url:$yt_option.base_path+"/fileUpDownload/uploadSDK?modelCode=PHOTO_APP",data:{sdk:str},success:function(data){if(data.flag==0){photoAll.appendImg(data.data.pkId,data.data.fileName,ithisParent)}else{$yt_alert_Model.prompt(data.msg)}},error:function(data){}})},appendImg:function(pkId,fileName,ithisParent,itemId){imgUlr=$yt_option.base_path+'fileUpDownload/download?pkId='+pkId+'&isDownload=false';var cla=photoAll.isImgFormat(fileName)?'file-preview':'no-img';var imgType=fileName.split('.');photoAll.fileName=imgType[1];var onkey='onkeyup="this.value=this.value.replace(/\\./g,\'\')"';var attaElement=$('<div id="'+pkId+'" class="file-lable" fid="'+pkId+'" itemId="'+(itemId||'')+'"><img class="file-img '+cla+'" src="'+imgUlr+'"><label class="file-del"></label><input type="text" class="file-name" value="'+imgType[0]+'" '+onkey+'><div class="file-name-bg"></div></div>');attaElement.find(".file-del").click(function(){var me=$(this);$yt_alert_Model.alertOne({alertMsg:"确认删除吗?",confirmFunction:function(){me.parent('.file-lable').remove()}})});attaElement.find('.no-img').click(function(){$yt_alert_Model.prompt('非图片文件，无法预览',2000)});ithisParent.append(attaElement);$('.file-img-div .file-preview').showImg()},appendImgDetail:function(pkId,fileName,ithisParent){imgUlr=$yt_option.base_path+'fileUpDownload/download?pkId='+pkId+'&isDownload=false';var cla=photoAll.isImgFormat(fileName)?'file-preview':'no-img';var attaElement=$('<div id="'+pkId+'" class="file-lable" fid="'+pkId+'"><img class="file-img '+cla+'" src="'+imgUlr+'"><div class="file-down-bg">下载</div><div class="text-overflow-photo" title="'+fileName+'">'+fileName+'</div></div>');attaElement.find(".file-down-bg").off().on('click',function(){window.location.href=$yt_option.base_path+'fileUpDownload/download?pkId='+pkId+'&isDownload=true'});attaElement.find('.no-img').click(function(){$yt_alert_Model.prompt('非图片文件，无法预览',2000)});ithisParent.append(attaElement);$('.file-img-div .file-preview').showImg()},fileUpDataConfig:function(str){if(photoAll.fileClickObj){GetBase64FromFile(str)}},isImgFormat:function(name){if(name){var format=name.split('.')[1];if(format=='jpg'||format=='png'){return true}}return false}};$(function(){if(photoAll.isExitsFunction('loadActiveX')){loadActiveX()}photoAll.init()});